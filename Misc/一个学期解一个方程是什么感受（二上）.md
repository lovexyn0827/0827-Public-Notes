# 一个学期解一个方程是什么感受

刚才一路上感觉如何？哦，有点累吗，让我们来换一个方向放松一下。

## 起步

来看这样一个方程：
$$
\begin{cases}
x'=y\\
y'=-x
\end{cases}\tag{1.93}
$$
并不难解。我们只需对第一个方程两边同时求导，然后与第二个方程联立，就可以将其转化成
$$
x''=y'=-x\tag{1.94}
$$
这样我们就会解了
$$
\begin{cases}
x=A\sin(t+\varphi)\\
y=A\cos(t+\varphi)
\end{cases}\tag{1.95}
$$
> 先关于$x$求解，然后求解$y$。$x$的解法此处不详细展开。

## 高歌猛进

### Things start to get serious...

不够捣鼓的？再来一个这样的呢？
$$
\begin{cases}
x'=x+y\\
y'=x-y
\end{cases}\tag{1.96}
$$
emmm...不像上边那个那么好代入了。而且，可以发现，我们也不能通过求解线性方程组的方法将含$x$的部分和含$y$的部分分离开来，因为上边的方程是一个关于$x$、$y$、$x'$、$y'$的四元方程组，但是我们只有两个方程可以联立。

到这里，再次回想一下我们最初遇到的方程$x'=kx$，之前我们曾使用过我们构造的其他函数替换其中的$x$，得到了诸如$(x'+2x)'=k(x'+2x)$的方程，从而推进求解的过程。这里我们依然可以通过构造函数来求解上面的方程组。

不过，第一眼看去，我们会发现我们似乎不能直接地从单独的某一个方程中“提炼出”一种形如$\lambda x+\mu y$的新函数，并以此构造出那种$x'=kx$的形式。究其本质，是因为单独的某一个方程当中含$x$的部分的系数比和含$y$的部分的系数比是失衡的，即$x'$的系数与$x$的系数的比值不等于$y'$的系数与$y$的系数的比值——一个方程中前者大于后者，而另一个方程组后者大于前者。

到这里我们不免会想到，我们能否用一种方法“整合”两个式子，使它们中系数比的不平衡性相互抵消，从而正好得到一个具有$(\lambda x+\mu y)'=k(\lambda x+\mu y)$这一形式的方程呢？

答案是肯定的。事实上，我们可以按照一定比例将一个方程“加到”另一个方程上来获得我们所需要的新方程：
$$
x'+\lambda y'=x+y+\lambda(x-y)\tag{1.97}
$$
即
$$
x'+\lambda y'=(1+\lambda)x+(1-\lambda)y\tag{1.98}
$$
使其系数成比例
$$
\frac{1}{\lambda}=\frac{1+\lambda}{1-\lambda}\tag{1.99}
$$
或者用可以规避“增根”的乘积式表示
$$
\lambda(1+\lambda)=1\cdot(1-\lambda)\tag{1.100}
$$
即
$$
\lambda^2+2\lambda-1=0\tag{1.101}
$$
解得
$$
\lambda=-1\pm\sqrt2\tag{1.102}
$$
将其回代到我们的方程$(1.98)$
$$
x'+(-1+\sqrt2)y'=\sqrt2[x+(-1+\sqrt2)y]\tag{1.103}
$$

$$
x'+(-1-\sqrt2)y'=-\sqrt{2}[x+(-1-\sqrt2)y]\tag{1.104}
$$

解得
$$
x+(-1+\sqrt2)y=C_1e^{\sqrt2t}\tag{1.105}
$$

$$
x+(-1-\sqrt2)y=C_2e^{-\sqrt2t}\tag{1.106}
$$

解得
$$
x=\left(\frac{\sqrt2}4+\frac12\right)C_1e^{\sqrt2t}-\left(\frac{\sqrt2}4-\frac12\right)C_2e^{-\sqrt2t}\tag{1.107}
$$

$$
y=\frac{\sqrt2}4\left(C_1e^{\sqrt2t}-C_2e^{-\sqrt2t}\right)\tag{1.108}
$$

没想到，那么简单的一个方程，解完之后居然会有如此不优雅的形式。

嗯，只能说，上边的方程组只是计算复杂，并没有太大的一般意义。下边才开始真正地进入“正片”：
$$
\begin{cases}
x'=ax+by\\
y'=cx+dy
\end{cases}\tag{1.109}
$$
为了保持对称性，我们这里将两式分别乘以一个可变的系数
$$
px'+qy'=p(ax+by)+q(cx+dy)\tag{1.110}
$$
即
$$
px'+qy'=(pa+qc)x+(pb+qd)y\tag{1.111}
$$
同样考虑到系数成比例
$$
q(pa+qc)=p(pb+qd)\tag{1.112}
$$
即
$$
bp^2+(d-a)pq-cq^2=0\tag{1.113}
$$
若$b$、$c$均为0，式$(1.109)$实际上可以被写成$x'=ax$与$y'=dy$这两个独立的方程，不需要我们再进行这种构造。考虑到$b=0$但$c\ne0$的情形可在交换函数$x$、$y$的位置后归入$b\ne0$的情形，我们在这里只讨论$b\ne0$的情况

此时易解得
$$
p=\frac{(a-d)q\pm\sqrt{(a-d)^2q^2+4bcq^2}}{2b}=\frac{a-d\pm\sqrt{(a-d)^2+4bc}}{2b}q\tag{114}
$$
代入式$(1.111)$有
$$
\begin{eqnarray}
&&\frac{a-d\pm\sqrt{(a-d)^2+4bc}}{2b}qx'+qy'\\
&=&\left(\frac{a-d\pm\sqrt{(a-d)^2+4bc}}{2b}a+c\right)qx+\left(\frac{a-d\pm\sqrt{(a-d)^2+4bc}}{2b}b+d\right)qy\\
&=&\frac{a^2-ad+2bc\pm a\sqrt{(a-d)^2+4bc}}{2b}qx+\frac{a+d\pm\sqrt{(a-d)^2+4bc}}{2}qy\\
&=&\frac{a+d\pm\sqrt{(a-d)^2+4bc}}{2}\left(\frac{a-d\pm\sqrt{(a-d)^2+4bc}}{2b}qx'+qy'\right)
\end{eqnarray}\tag{115}
$$

> 最后一步的因式分解相对困难，可以借助前边得到的系数比例关系辅以相关的验证直接给出答案

我们回过来讨论一下$p$、$q$的取值情况。由式$(110)$可知，如果$q=0$，那么方程组中第二个等式将不会在式$(110)$中出现。这意味着，这时仅使用原方程组的第一个等式两边同时乘以$p$后得到的方程即已达到了“平衡系数比例”这个目的，换言之，第一个等式已经符合了$f'=kf$这种形式，我们没有必要再进行那种通过“混合”两方程“平衡系数比例”的操作。所以，我们不需要考虑$p=0$的情况。对于$p$，亦有相似的结论成立。

因为此处可以假定$q\ne0$，不妨设$q=1$（也相当于两端同时除以$q$），式$(115)$可写作
$$
\frac{a-d\pm\sqrt{(a-d)^2+4bc}}{2b}x'+y'
=\frac{a+d\pm\sqrt{(a-d)^2+4bc}}{2}\left(\frac{a-d\pm\sqrt{(a-d)^2+4bc}}{2b}x'+y'\right)\tag{116}
$$
根据式中“$\pm$”符号的指代不同（对应方程$(113)$的两根），我们可以将上式表示为两个独立的微分方程
$$
\frac{a-d+\sqrt{(a-d)^2+4bc}}{2b}x'+y'
=\frac{a+d+\sqrt{(a-d)^2+4bc}}{2}\left(\frac{a-d+\sqrt{(a-d)^2+4bc}}{2b}x'+y'\right)\tag{117}
$$

$$
\frac{a-d-\sqrt{(a-d)^2+4bc}}{2b}x'+y'
=\frac{a+d-\sqrt{(a-d)^2+4bc}}{2}\left(\frac{a-d-\sqrt{(a-d)^2+4bc}}{2b}x'+y'\right)\tag{118}
$$

根据上述两方程，我们构造
$$
u=\frac{a-d+\sqrt{(a-d)^2+4bc}}{2b}x+y\tag{119}
$$

$$
v=\frac{a-d-\sqrt{(a-d)^2+4bc}}{2b}x+y\tag{120}
$$

则式$(117)$、$(118)$可写作
$$
u'=\frac{a+d+\sqrt{(a-d)^2+4bc}}{2}u\tag{121}
$$

$$
v'=\frac{a+d-\sqrt{(a-d)^2+4bc}}{2}v\tag{122}
$$

解得
$$
u=\frac{a-d+\sqrt{(a-d)^2+4bc}}{2b}x+y=C_1e^{\frac{a+d+\sqrt{(a-d)^2+4bc}}{2}t}\tag{123}
$$

$$
v=\frac{a-d-\sqrt{(a-d)^2+4bc}}{2b}x+y=C_2e^{\frac{a+d-\sqrt{(a-d)^2+4bc}}{2}t}\tag{124}
$$

$(a-d)^2+4bc\ne0$时解得
$$
x=\frac{b}{\sqrt{(a-d)^2+4bc}}\left(C_1e^{\frac{a+d+\sqrt{(a-d)^2+4bc}}{2}t}-C_2e^{\frac{a+d-\sqrt{(a-d)^2+4bc}}{2}t}\right)\tag{125}
$$

$$
y=\frac{d-a}{2\sqrt{(a-d)^2+4bc}}C_1e^{\frac{a+d+\sqrt{(a-d)^2+4bc}}{2}t}-\frac{2\sqrt{(a-d)^2+4bc}+d-a}{2\sqrt{(a-d)^2+4bc}}C_2e^{\frac{a+d-\sqrt{(a-d)^2+4bc}}{2}t}\tag{126}
$$

这即为原方程的解，其不对称性来自于假设$q=1$。

$(a-d)^2+4bc=0$时，且将$(123)$、$(124)$式简写成
$$
\frac{a-d}{2b}x+y=Ce^{\frac{a+d}{2}t}\tag{127}
$$
这时式$(123)$、$(124)$“重合”为了一个方程，无法通过联立求解。这一方程与原方程组组成了关于$x$、$y$、$x'$、$y'$的四元线性方程组，但是，这一方程组仅有三个方程，不足以唯一确定$x$、$y$的表达式。经过各种尝试，仍未能解出$x$、$y$。

一元微分方程在出现重根时也可以相对容易地求解，但是解方程组时遇到的重根却使得我们毫无头绪。这到底是我们的求解方法不够完善，还是方程本身就无法求解呢？

### Speeding up

先放下这个问题等有机会再看，现在先看一下更一般的情况：
$$
\begin{cases}
\begin{matrix}
x_1'=a_{1,1}x_1+a_{1,2}x_2+\cdots+a_{1,n}x_n\\
x_2'=a_{2,1}x_1+a_{2,2}x_2+\cdots+a_{2,n}x_n\\
\vdots\\
x_n'=a_{n,1}x_1+a_{n,2}x_2+\cdots+a_{n,n}x_n\\
\end{matrix}
\end{cases}\tag{128}
$$
看到这种形式，大家联想到了什么呢？
$$
\begin{cases}
\begin{matrix}
y_1=a_{1,1}x_1+a_{1,2}x_2+\cdots+a_{1,n}x_n\\
y_2=a_{2,1}x_1+a_{2,2}x_2+\cdots+a_{2,n}x_n\\
\vdots\\
y_3=a_{n,1}x_1+a_{n,2}x_2+\cdots+a_{n,n}x_n\\
\end{matrix}
\end{cases}\tag{129}
$$
我们知道，使用矩阵形式表示线性方程组可以为进一步的研究带来极大的便利，那么，借助矩阵这一工具表示我们的微分方程组会不会也为我们带来帮助呢？

经过类比，我们可以把原方程组$(128)$写作
$$
\left(
\begin{matrix}
a_{1,1}&a_{1,2}&\cdots&a_{1,n}\\
a_{2,1}&a_{2,2}&\cdots&a_{2,n}\\
\vdots&\vdots&&\vdots\\
a_{n,1}&a_{n,2}&\cdots&a_{n,n}\\
\end{matrix}
\right)
\left(
\begin{matrix}
x_1\\
x_2\\
\vdots\\
x_n\\
\end{matrix}
\right)
=
\left(
\begin{matrix}
x_1'\\
x_2'\\
\vdots\\
x_n'\\
\end{matrix}
\right)\tag{130}
$$
设$\boldsymbol A=\left(
\begin{matrix}
a_{1,1}&a_{1,2}&\cdots&a_{1,n}\\
a_{2,1}&a_{2,2}&\cdots&a_{2,n}\\
\vdots&\vdots&&\vdots\\
a_{n,1}&a_{n,2}&\cdots&a_{n,n}\\
\end{matrix}
\right)$，$\boldsymbol X=\left(
\begin{matrix}
x_1\\
x_2\\
\vdots\\
x_n\\
\end{matrix}
\right)$，$\boldsymbol {X'}=\left(
\begin{matrix}
x_1'\\
x_2'\\
\vdots\\
x_n'\\
\end{matrix}
\right)$，可将上式改写为
$$
\boldsymbol{AX}=\boldsymbol{X'}\tag{131}
$$
仿照前边通过使方程“相加”来平衡系数比例、方便构造新函数的方法，可对式$(128)$中各方程“混合”如下
$$
\sum_{i=1}^{n}\lambda_ix_i'=\sum_{i=1}^{n}\lambda_i\sum_{j=1}^{n}a_{i,j}x_j\tag{132}
$$
设$\boldsymbol\Lambda=(\lambda_1,\lambda_2,\cdots,\lambda_n)$，上述“混合”对应到式$(131)$中即为
$$
\boldsymbol{\Lambda AX}=\boldsymbol{\Lambda X'}\tag{133}
$$
两端同时转置
$$
(\boldsymbol{\Lambda AX})^T=\boldsymbol X^T\boldsymbol A^T\boldsymbol\Lambda^T=(\boldsymbol{\Lambda X'})^T=\boldsymbol{X'}^T\boldsymbol{\Lambda}^T\tag{134}
$$
即
$$
\boldsymbol X^T\boldsymbol A^T\boldsymbol\Lambda^T=\boldsymbol{X'}^T\boldsymbol{\Lambda}^T\tag{135}
$$
$\boldsymbol A^T\boldsymbol\Lambda^T$与$\boldsymbol{\Lambda}^T$均为$n\times 1$的矩阵，设其第$i$行元素分别为$r_i$、$s_i$，则上式可表示为
$$
\sum_{i=1}^nr_ix_i=\sum_{i=1}^ns_ix_i'\tag{136}
$$
为使$x_i$与$x_i'$的系数$r_i$、$s_i$成比例，则亦$\boldsymbol A^T\boldsymbol\Lambda^T$与$\boldsymbol{\Lambda}^T$应线性相关，可写作
$$
\boldsymbol A^T\boldsymbol\Lambda^T=\alpha\boldsymbol{\Lambda}^T\tag{137}
$$
这时，我们不难注意到$\alpha$为$\boldsymbol{A}^T$的特征值，$\boldsymbol{\Lambda}^T$为相应的特征向量。

> 这里我们使用$\boldsymbol I$，而不是一些线性代数教材中的$\boldsymbol E$表示单位矩阵。

容易知道，$\boldsymbol{A}^T$会有$n$个特征值（以$|\boldsymbol{A}^T-\alpha\boldsymbol I|=0$根的个数计，重根可重计），不妨设它们为$\alpha_1$、$\alpha_2$、$\cdots$、$\alpha_n$，对应的一个特征向量分别为$\boldsymbol{\Lambda}^T_1$、$\boldsymbol{\Lambda}^T_2$、$\cdots$、$\boldsymbol{\Lambda}^T_n$。可以解得
$$
\boldsymbol{\Lambda}_i\boldsymbol{X}=C_ie^{\alpha_it}\tag{138}
$$
如果这$n$个特征根均互异，则总共可以得到$n$个互异且形同上式的方程，可将它们表示为
$$
\left(
\begin{matrix}
\boldsymbol{\Lambda}_1\\\boldsymbol{\Lambda}_2\\\vdots\\\boldsymbol{\Lambda}_n
\end{matrix}
\right)\boldsymbol{X}=
\left(
\begin{matrix}
C_1e^{\alpha_1t}\\C_2e^{\alpha_2t}\\\vdots\\C_ne^{\alpha_nt}
\end{matrix}
\right)\tag{139}
$$
若设$\boldsymbol L=\left(
\begin{matrix}
\boldsymbol{\Lambda}_1\\\boldsymbol{\Lambda}_2\\\vdots\\\boldsymbol{\Lambda}_n
\end{matrix}
\right)$，$\boldsymbol F=\left(
\begin{matrix}
C_1e^{\alpha_1t}\\C_2e^{\alpha_2t}\\\vdots\\C_ne^{\alpha_nt}
\end{matrix}
\right)$，则上式可表示为
$$
\boldsymbol{LX}=\boldsymbol{F}\tag{140}
$$
该等式为一个非齐次线性方程组。考虑到$n$个互异的特征根对应的特征向量均线性无关，则$\boldsymbol L$为可逆矩阵，继而可通过在上式两边同时左乘$\boldsymbol L^{-1}$得到
$$
\boldsymbol X=\boldsymbol L^{-1}\boldsymbol F\tag{141}
$$
这即为原微分方程的解。其中，$\boldsymbol F$给出了方程组的解中各项除系数以外的部分的形式，而$\boldsymbol L^{-1}$描述了它们应满足的比例关系。

下面再来考虑特征根取值不满足上述假设的情况。

## 第一次曲折

> 这一节的来历：之前，在求解$(138)$式时误引入了限制条件$\alpha\ne0$，并处理之。虽事后发现其并无必要，但考虑到其中引入的重要思想方法，以及对探索过程再现的诚实性，故保留。

先来看特征根存在0根的情形。若0为$\boldsymbol A^T$的一个特征根，则有
$$
|\boldsymbol{A}^T-0\cdot\boldsymbol E|=|\boldsymbol A|=0\tag{142}
$$
也就是说，$\boldsymbol A$不为满秩矩阵。很显然，当$x_1$、$x_2$、$\cdots$、$x_n$中存在至少一对相同的函数时，上述结论成立，但是，反过来，这一规律是否依然成立呢？

### Step by step...

不过，现在，我们的思路似乎进入了死胡同。不论如何，让我们先试着从最简单的情况寻找一丝蛛丝马迹：
$$
\left(\begin{matrix}x'\\y'\end{matrix}\right)=\left(\begin{matrix}a_{11}&a_{12}\\a_{21}&a_{22}\end{matrix}\right)\left(\begin{matrix}x\\y\end{matrix}\right)\tag{143}
$$
鉴于这里我们只考虑$\boldsymbol A=\left(\begin{matrix}a_{11}&a_{12}\\a_{21}&a_{22}\end{matrix}\right)$不为满秩矩阵的情形，我们不妨假定$r(\boldsymbol A)=1$。这时，$\boldsymbol A$的两行向量线性相关，我们可以将其第一行乘以一个倍数后加在第二行上，使得这样变换后第二行成为零向量。我们可以用初等矩阵$\boldsymbol E_{21(\lambda)}$与$\boldsymbol A$相乘的形式表示这一变换：
$$
\boldsymbol E_{21(\lambda)}\boldsymbol A=\left(\begin{matrix}1&0\\\lambda&1\end{matrix}\right)\boldsymbol A=\left(\begin{matrix}a_{11}&a_{12}\\a_{21}+\lambda a_{11}&a_{22}+\lambda a_{22}\end{matrix}\right)=\left(\begin{matrix}a_{11}&a_{12}\\0&0\end{matrix}\right)\tag{144}
$$
> 假使第一行某元素为0，因为两行线性相关，第二行对应元亦为0，此时不论$\lambda$取何值，上式都成立。

若将$\boldsymbol E_{21(\lambda)}$同时左乘到方程$(143)$两侧，有
$$
\boldsymbol E_{21(\lambda)}\left(\begin{matrix}x'\\y'\end{matrix}\right)=\left(\begin{matrix}x'\\y'+\lambda x'\end{matrix}\right)=\left(\begin{matrix}a_{11}&a_{12}\\0&0\end{matrix}\right)\left(\begin{matrix}x\\y\end{matrix}\right)\tag{145}
$$
这一步本质上是两个等式的“加权相加”操作。

实际上可将上式分解为两个方程
$$
x'=a_{11}x+a_{12}y\tag{146}
$$

$$
y'+\lambda x'=0\tag{147}
$$

对$(147)$两边同时取不定积分并作移项处理
$$
y=C_1-\lambda x\tag{148}
$$
代入$(146)$
$$
x'=(a_{11}-\lambda a_{12})x+a_{12}C_1\tag{149}
$$
解得
$$
x=e^{(a_{11}-\lambda a_{12})t}\int e^{-(a_{11}-\lambda a_{12})t}a_{12}C_1dt=C_2e^{(a_{11}-\lambda a_{12})t}-\frac{a_{12}C_1}{a_{11}-\lambda a_{12}}\tag{150}
$$

$$
y=C_1-\lambda x=C_1+\frac{\lambda a_{12}C_1}{a_{11}-\lambda a_{12}}-\lambda C_2e^{(a_{11}-\lambda a_{12})t}\tag{151}
$$

注意这里我们实际上假定了$a_{11}-\lambda a_{12}\ne0$，如果这一假设不成立，即$a_{11}-\lambda a_{12}=0$，那么
$$
x=a_{12}C_1t+C_2\tag{152}
$$

$$
y=-\lambda a_{12}C_1t+C_1-\lambda C_2\tag{153}
$$

到这里，我们顺带来看一看$a_{11}-\lambda a_{12}=0$更深层的意义。我们有理由猜测，这一等式与特征方程$|\boldsymbol A-\alpha\boldsymbol I|=0$存在重根有关。

> 理由在于，上面的等式长得很像各种判别式的边界情况，或者说，其值取0的情形与方程有重根同样“测度为0”。

首先，我们尝试将$\lambda$替换为可由$\boldsymbol A$中元素表达的形式。因为行向量的线性相关关系，我们有
$$
(a_{21}+\lambda a_{11},a_{22}+\lambda a_{12})=\boldsymbol O\tag{154}
$$
继而，我们有
$$
\lambda a_{12}=-a_{22}\tag{155}
$$
代入$a_{11}-\lambda a_{12}=0$可得
$$
a_{11}+a_{22}=0\tag{156}
$$
列出特征方程
$$
\alpha^2-(a_{11}+a_{22})\alpha+a_{11}a_{22}-a_{12}a_{21}=0\tag{157}
$$
考虑到$(156)$及$|\boldsymbol A|=a_{11}a_{22}-a_{12}a_{21}=0$，$(157)$又可以写作
$$
\alpha^2=0\tag{158}
$$
所以此时$\boldsymbol A$的两个特征值相等且为0。

这样，我们得知，系数矩阵不可逆或者是拥有重根都不必然意味着原方程组不可求解。

另外，显然地，$r(\boldsymbol A)=0$时，各个变量的导数均为0，各变量均为初值条件确定的常函数。

或许到这里规律已经初现端倪，但终归还是有一点点模糊，而且二元方程的变量也存在一些缺陷，即相应系数矩阵$\boldsymbol A$非满秩必然意味着其所有行向量成比例，而且受阶数限制不能区分系数矩阵的秩取不同非零值的情形，一般性略受限制。

所以，我们再来看三个未知函数的情形
$$
\left(\begin{matrix}x'\\y'\\z'\end{matrix}\right)=\left(\begin{matrix}a_{11}&a_{12}&a_{13}\\a_{21}&a_{22}&a_{23}\\a_{31}&a_{32}&a_{33}\end{matrix}\right)\left(\begin{matrix}x\\y\\z\end{matrix}\right)\tag{159}
$$
先看$r(\boldsymbol A)=2$的情形。考虑到对称性，我们不妨假设$\boldsymbol A$的前两行对应的行向量为其一个最大无关组，可以通过与在两个未知函数的情形中使用的方法相似的方式将系数矩阵的第三行化为0。
$$
\left(\begin{matrix}x'\\y'\\z'+\lambda x'+\mu y'\end{matrix}\right)=\left(\begin{matrix}a_{11}&a_{12}&a_{13}\\a_{21}&a_{22}&a_{23}\\0&0&0\end{matrix}\right)\left(\begin{matrix}x\\y\\z\end{matrix}\right)\tag{160}
$$
从中依然可提取三个方程，但是限于篇幅我们不再一一列出。但是，这里我们仍将专门提取出$(160)$的“第三行”对应的方程：
$$
z'+\lambda x'+\mu y'=0\tag{161}
$$
比起二元的情形，这种形式更加鲜明地体现出它的本质，即给出了各未知函数导数间的线性相关关系。通过对两边取不定积分，我们得知
$$
z+\lambda x+\mu y=C\tag{162}
$$
这意味着，式$(161)$实际上也给出了各个未知变量间的那种“类似线性相关”的关系。这里，经由这样的关系，我们可以将$z$用$x$、$y$表示出，将这种表示式代入其它方程当中，我们实际上达成了消元的目的。

### Diving down

把握住这一本质后，我们先放下手中的具体计算，开始转向更一般的情形。

列出方程
$$
\boldsymbol X'=\boldsymbol A\boldsymbol X\tag{163}
$$
假设$n\times n$的系数矩阵$\boldsymbol A$的秩为$m\ge1$，且其前$m$行对应的行向量恰好线性无关，则我们可以通过变换将$\boldsymbol A$的其余行化为全零，而前$m$行不变。为了操作上的便利，我们不妨依然用在方程两边同时左乘以一个矩阵$\boldsymbol P$来描述这一变换。

仿照前边的形式，展开写出式$(163)$和我们需要的变换结果
$$
\left(\begin{matrix}
x_1'\\x_2'\\\vdots \\x_n'
\end{matrix}\right)
=\left(\begin{matrix}
a_{11}&a_{12}&\cdots&a_{1n}\\
a_{21}&a_{22}&\cdots&a_{2n}\\
\vdots&\vdots&&\vdots\\
a_{n1}&a_{n2}&\cdots&a_{nn}
\end{matrix}\right)
\left(\begin{matrix}
x_1\\x_2\\\vdots\\x_n
\end{matrix}\right)\tag{164}
$$

$$
\left(\begin{matrix}
x_1'\\x_2'\\\vdots \\x_m'\\
x_{m+1}+\sum_{i=1}^mp_{{m+1},i}x_i'\\
\vdots\\
x_{n}+\sum_{i=1}^mp_{{n},i}x_i'
\end{matrix}\right)
=\left(\begin{matrix}
a_{11}&a_{12}&\cdots&a_{1n}\\
a_{21}&a_{22}&\cdots&a_{2n}\\
\vdots&\vdots&&\vdots\\
a_{m1}&a_{m2}&\cdots&a_{mn}\\
0&0&\cdots&0\\
\vdots&\vdots&&\vdots\\
0&0&\cdots&0
\end{matrix}\right)
\left(\begin{matrix}
x_1\\x_2\\\vdots\\x_m\\x_{m+1}\\\vdots\\x_n
\end{matrix}\right)\tag{165}
$$

为了为操作提供便利，并严格化推导过程，我们将变换以矩阵相乘的形式表示。而且不难写出乘到原式左乘到原式两侧的矩阵$\boldsymbol P$的表达式的形式如下
$$
\boldsymbol P=\left(\begin{matrix}
1&0&\cdots&0\\
0&1&\cdots&0\\
\vdots&\vdots&&\vdots\\
0&0&\cdots&0\\
p_{m+1,1}&p_{m+1,2}&\cdots&p_{m+1,n}\\
\vdots&\vdots&&\vdots\\
p_{n,1}&p_{n,2}&\cdots&p_{n,n}\\
\end{matrix}\right)\tag{166}
$$
若将$\boldsymbol P$的上下两部分分别记为$\boldsymbol U$、$\boldsymbol V$，则可以将$(165)$拆分为两个方程组
$$
\boldsymbol U\boldsymbol X'=\boldsymbol {UAX}\tag{167}
$$

$$
\boldsymbol{VX}'=\boldsymbol{VAX}\tag{168}
$$

可以注意到，这两个方程等号两侧的值分别为$m\times 1$和$(n-m)\times 1$的矩阵，这实际上等于将原方程组中“性质不同”的两类方程分离开来，以便后续的求解。

另外，我们注意到，式$(168)$展开后实际上具有以下形式
$$
\left(\begin{matrix}
x_{m+1}+\sum_{i=1}^mp_{{m+1},i}x_i'\\
\vdots\\
x_{n}+\sum_{i=1}^mp_{{n},i}x_i'
\end{matrix}\right)
=\boldsymbol O\tag{169}
$$
其中，对于$k\gt m$，$x_{k}$的系数均为1或0，而且1这一取值仅在第$k$行存在。对应到矩阵形式当中，即意味着
$$
\forall i>m\land i>m, p_{i,j}=\begin{cases}0&i\ne j\\1&i=j\end{cases}\tag{170}
$$
继而可以得知，矩阵$\boldsymbol P$的右下角有单位矩阵的形式。继而可以将$\boldsymbol {U}$分解为
$$
\boldsymbol U=\left(\begin{matrix}
p_{m+1,1}&p_{m+1,2}&\cdots&p_{m+1,m}&1&0&\cdots&0\\
p_{m+2,1}&p_{m+2,2}&\cdots&p_{m+2,m}&0&1&\cdots&0\\
\vdots&\vdots&&\vdots&\vdots&\vdots&&\vdots\\
p_{n,1}&p_{n,2}&\cdots&p_{n,m}&0&0&\cdots&1\\
\end{matrix}\right)\tag{171}
$$
不妨将其写为分块形式
$$
\boldsymbol U=\left(\begin{matrix}\boldsymbol W&\boldsymbol I\end{matrix}\right)\tag{172}
$$
其中，$\boldsymbol W$这一分块由原始系数矩阵$\boldsymbol A$的具体取值确定，具有较大的可变性，而没有发现值得留意的规律，故作保留。、

综上，可将$\boldsymbol P$写作
$$
\boldsymbol P=\left(\begin{matrix}
1&0&\cdots&0&0&0&\cdots&0\\
0&1&\cdots&0&0&0&\cdots&0\\
\vdots&\vdots&&\vdots&\vdots&\vdots&&\vdots\\
0&0&\cdots&1&0&0&\cdots&0\\
p_{m+1,1}&p_{m+1,2}&\cdots&p_{m+1,m}&1&0&\cdots&0\\
p_{m+2,1}&p_{m+2,2}&\cdots&p_{m+2,m}&0&1&\cdots&0\\
\vdots&\vdots&&\vdots&\vdots&\vdots&&\vdots\\
p_{n,1}&p_{n,2}&\cdots&p_{n,m}&0&0&\cdots&1\\
\end{matrix}\right)\tag{173}
$$
而且可以总结出$\boldsymbol P$的结构
$$
\boldsymbol P=\left(\begin{matrix}
\boldsymbol I&\boldsymbol O\\
\boldsymbol W&\boldsymbol I
\end{matrix}\right)\tag{174}
$$
其中只有$\boldsymbol W$的取值是比较“随意”的。

相应地，我们也可以按照$\boldsymbol P$的结构对其他变量也进行对应的分块操作，以进一步实现“归类不同”的方程与变量的分离。
$$
\boldsymbol X=\left(\begin{matrix}
x_1\\\vdots\\x_m\\\hdashline x_{m+1}\\\vdots\\x_n
\end{matrix}\right)
=\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol X_H
\end{matrix}\right)\tag{175}
$$

$$
\boldsymbol A=\left(\begin{array}{c|c}
\begin{matrix}
a_{11}&\cdots&a_{1m}\\
\vdots&&\vdots\\
a_{m1}&\cdots&a_{mm}\\\hline
a_{(m+1)1}&\cdots&a_{(m+1)m}\\
\vdots&&\vdots\\
a_{n1}&\cdots&a_{nm}\\
\end{matrix}&
\begin{matrix}
a_{1(m+1)}&\cdots&a_{1n}\\
\vdots&&\vdots\\
a_{m(m+1)}&\cdots&a_{mn}\\\hline
a_{(m+1)(m+1)}&\cdots&a_{(m+1)n}\\
\vdots&&\vdots\\
a_{n(m+1)}&\cdots&a_{nn}\\
\end{matrix}
\end{array}\right)
=\left(\begin{matrix}
\boldsymbol A_{TL}&\boldsymbol A_{TR}\\
\boldsymbol A_{BL}&\boldsymbol A_{BR}
\end{matrix}\right)\tag{176}
$$

式$(163)$可写作
$$
\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol X_H
\end{matrix}\right)'=\left(\begin{matrix}
\boldsymbol X_L'\\\boldsymbol X_H'
\end{matrix}\right)=\left(\begin{matrix}
\boldsymbol A_{TL}&\boldsymbol A_{TR}\\
\boldsymbol A_{BL}&\boldsymbol A_{BR}
\end{matrix}\right)\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol X_H
\end{matrix}\right)\tag{177}
$$
式中对由函数组成矩阵求导的结果等于对矩阵的每个元素分别求导后的结果。

两边同时左乘$\boldsymbol P$
$$
\left(\begin{matrix}
\boldsymbol I&\boldsymbol O\\
\boldsymbol W&\boldsymbol I
\end{matrix}\right)\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol X_H
\end{matrix}\right)'=\left(\begin{matrix}
\boldsymbol I&\boldsymbol O\\
\boldsymbol W&\boldsymbol I
\end{matrix}\right)\left(\begin{matrix}
\boldsymbol A_{TL}&\boldsymbol A_{TR}\\
\boldsymbol A_{BL}&\boldsymbol A_{BR}
\end{matrix}\right)\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol X_H
\end{matrix}\right)\tag{178}
$$
即
$$
\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol W\boldsymbol X_L+\boldsymbol X_H
\end{matrix}\right)'=\left(\begin{matrix}
\boldsymbol A_{TL}&\boldsymbol A_{TR}\\
\boldsymbol W\boldsymbol A_{TL}\boldsymbol A_{BL}&\boldsymbol W\boldsymbol A_{TR}\boldsymbol A_{BR}
\end{matrix}\right)\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol X_H
\end{matrix}\right)\tag{179}
$$
考虑到我们进行这一变换的目的，也就是将系数矩阵的一个最大无关行向量组以外的行变换为全零，可以将上式写成
$$
\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol W\boldsymbol X_L+\boldsymbol X_H
\end{matrix}\right)'=\left(\begin{matrix}
\boldsymbol A_{TL}&\boldsymbol A_{TR}\\
\boldsymbol O&\boldsymbol O
\end{matrix}\right)\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol X_H
\end{matrix}\right)=\left(\begin{matrix}
\boldsymbol A_{TL}\boldsymbol X_L+\boldsymbol A_{TR}\boldsymbol X_H\\\boldsymbol O
\end{matrix}\right)\tag{180}
$$
继而可以将上式“拆解”为两个等式
$$
\boldsymbol X_L'=\boldsymbol A_{TL}\boldsymbol X_L+\boldsymbol A_{TR}\boldsymbol X_H\tag{181}
$$

$$
\boldsymbol W\boldsymbol X_L'+\boldsymbol X_H'=\boldsymbol O\tag{182}
$$

为了方便接下来的表述，我们在此定义对矩阵的不定积分操作
$$
\int\left(\begin{matrix}
f_{11}&f_{12}&\cdots&f_{1n}\\
f_{21}&f_{22}&\cdots&f_{2n}\\
\vdots&\vdots&&\vdots\\
f_{m1}&f_{m2}&\cdots&f_{mn}
\end{matrix}\right)dt=
\left(\begin{matrix}
\displaystyle\int f_{11}dt&\displaystyle\int f_{12}dt&\cdots&\displaystyle\int f_{1n}dt\\
\displaystyle\int f_{21}dt&\displaystyle\int f_{22}dt&\cdots&\displaystyle\int f_{2n}dt\\
\vdots&\vdots&&\vdots\\
\displaystyle\int f_{m1}dt&\displaystyle\int f_{m2}dt&\cdots&\displaystyle\int f_{mn}dt\\
\end{matrix}\right)\tag{183}
$$
或者更简单地表示为
$$
\int(f_{ij})dt=\left(\int f_{ij}dt\right)\tag{184}
$$
即对由函数组成矩阵进行积分的结果等于对矩阵的每个元素分别进行积分。

我们直观地认为，经由$(182)$我们可以导出
$$
\int (\boldsymbol W\boldsymbol X_L'+\boldsymbol X_H')dt=\boldsymbol W\boldsymbol X_L+\boldsymbol X_H=\int\boldsymbol O dt=\boldsymbol C\tag{185}
$$
式中$\boldsymbol C$为由初值条件确定的常数矩阵。因为两边的不定积分引入的“积分常数”实际上可以通过移项“合并”，所以这里只在一侧给出了$\boldsymbol C$。

为了证明上边的结论，这里我们需要证明以下两个等式，以验证对矩阵的积分和对单个函数的积分的相似性
$$
\int(\boldsymbol A+\boldsymbol B)dt=\int\boldsymbol Adt+\int\boldsymbol Bdt\tag{186}
$$

$$
\int\boldsymbol Y'dt=\boldsymbol Y+\boldsymbol C\tag{187}
$$

它们的证明是显然的
$$
\begin{eqnarray}
\int\boldsymbol Adt+\int\boldsymbol Bdt
&=&\int(a_{ij})dt+\int(b_{ij})dt&=&\left(\int a_{ij}dt\right)+\left(\int a_{ij}dt\right)\\
&=&\left(\int a_{ij}dt+\int a_{ij}dt\right)\\
&=&\left(\int (a_{ij}+b_{ij})dt\right)\\
&=&\int (a_{ij}+b_{ij})dt\\
&=&\int(\boldsymbol A+\boldsymbol B)dt
\end{eqnarray}\tag{188}
$$

$$
\int\boldsymbol Y'dt=\int(y_{ij}')dt=\left(\int y_{ij}'dt\right)=\left(y_{ij}+c_{ij}\right)=\boldsymbol Y+\boldsymbol C\tag{189}
$$

所以
$$
\int (\boldsymbol W\boldsymbol X_L'+\boldsymbol X_H')dt=\int\boldsymbol W\boldsymbol X_L'dt+\int\boldsymbol X_H'dt=\boldsymbol W\boldsymbol X_L+\boldsymbol X_H+\boldsymbol C_1=\int\boldsymbol O dt=\boldsymbol C_1\tag{190}
$$
即
$$
\boldsymbol W\boldsymbol X_L+\boldsymbol X_H=\boldsymbol C\tag{191}
$$
可以借助此式得到$\boldsymbol X_H$的一个表达式
$$
\boldsymbol X_H=\boldsymbol C-\boldsymbol{WX}_L\tag{192}
$$
代入式$(181)$
$$
\boldsymbol X_L'=(\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W)\boldsymbol X_L+\boldsymbol{A}_{TR}\boldsymbol C\tag{193}
$$
这时我们将系数矩阵不可逆的原方程组化简为了另一个形式相近但可能可以使用简易方法处理的方程组。

接下来，我们借助处理系数矩阵可逆、特征值无重根的方程组的方法求解上述该方程。

将$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W$的一个特征向量$\boldsymbol\Lambda^T$的转置$\boldsymbol\Lambda$左乘在上式两端
$$
\boldsymbol{\Lambda X}_L'=\boldsymbol{\Lambda}(\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W)\boldsymbol X_L+\boldsymbol{\Lambda}\boldsymbol{A}_{TR}\boldsymbol C\tag{194}
$$
设$\boldsymbol\Lambda$对应的特征值为$\alpha$，则
$$
(\boldsymbol\Lambda(\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W))^T=(\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W)^T\boldsymbol\Lambda^T=\alpha\boldsymbol\Lambda^T\tag{195}
$$
两端同时转置
$$
\boldsymbol\Lambda(\boldsymbol A_{TL}-\boldsymbol W\boldsymbol A_{TR})=\alpha\boldsymbol\Lambda\tag{196}
$$
代入$(194)$
$$
\boldsymbol\Lambda\boldsymbol X_L'=\alpha\boldsymbol\Lambda\boldsymbol X_L+\boldsymbol{\Lambda}\boldsymbol{A}_{TR}\boldsymbol C\tag{197}
$$
假设$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W$存在$m$个相异的特征值$\alpha_1$、$\cdots$、$\alpha_m$，则可以得到$\boldsymbol\Lambda_1$到$\boldsymbol\Lambda_m$这样$m$个线性无关的特征向量。对于每一组这样的取值，我们可以取得式$(197)$的一个具体表示
$$
\boldsymbol\Lambda_i\boldsymbol X_L'=\alpha_i\boldsymbol\Lambda_i\boldsymbol X_L+\boldsymbol{\Lambda}_i\boldsymbol{A}_{TR}\boldsymbol C\tag{198}
$$
可以注意到，上式两边均为标量，所以理应可以使用处理标量微分方程的方法求解上面的方程。但是，首先我们需要证明$\boldsymbol\Lambda_i \boldsymbol X_L'=(\boldsymbol\Lambda_i \boldsymbol X_L)'$，以便将其化为形如$y'=\alpha y+f$的形式。

为了不失一般性，我们设两个可依次相乘的矩阵，$\boldsymbol A=(a_{ij})$、$\boldsymbol B=(b_{ij})$，且两者的元素分别为纯常数和关于$t$的函数。然后
$$
\boldsymbol A\boldsymbol B'=\boldsymbol A(b_{ij}')=\left(\sum_{i=1}^ka_{i,k}b_{k,j}'\right)=\left(\left(\sum_{i=1}^ka_{i,k}b_{k,j}\right)'\right)=\left(\sum_{i=1}^ka_{i,k}b_{k,j}\right)'=(\boldsymbol{AB})'\tag{199}
$$
这样，式$(198)$也可写作
$$
(\boldsymbol\Lambda_i\boldsymbol X_L)'=\alpha_i\boldsymbol\Lambda_i\boldsymbol X_L+\boldsymbol{\Lambda}_i\boldsymbol{A}_{TR}\boldsymbol C\tag{200}
$$
考虑到上式为一个标量的微分方程，可直接解得
$$
\boldsymbol\Lambda_i\boldsymbol X_L=e^{\alpha_i t}\int e^{-\alpha_i t}\boldsymbol{\Lambda}_i\boldsymbol{A}_{TR}\boldsymbol Cdt=f_i\tag{201}
$$
这里类似地设$\boldsymbol L=\left(
\begin{matrix}
\boldsymbol{\Lambda}_1\\\boldsymbol{\Lambda}_2\\\vdots\\\boldsymbol{\Lambda}_m
\end{matrix}
\right)$，$\boldsymbol F=\left(
\begin{matrix}
f_1\\f_2\\\vdots\\f_n
\end{matrix}
\right)$，则有
$$
\boldsymbol {LX}_L=\boldsymbol F\tag{202}
$$
考虑到$\boldsymbol\Lambda_1$到$\boldsymbol\Lambda_m$组成的向量组线性无关，$\boldsymbol L$为可逆矩阵，则可解得
$$
\boldsymbol X_L=\boldsymbol L^{-1}\boldsymbol F\tag{203}
$$
代入$(192)$
$$
\boldsymbol X_H=\boldsymbol C-\boldsymbol W\boldsymbol L^{-1}\boldsymbol F\tag{204}
$$
至此，我们完成了对原方程的求解。

经由分析可知，消元过程当中出现的$\boldsymbol C$和$(201)$中的不定积分分别引入了$(n-m)$和$m$个独立常数，整体上，整个求解过程中引入了$n$个初值条件确定的常数。

但是，在这一求解过程当中，我们依然作出了很多的假定，如果假定不能被满足，那么我们需要再次重复类似的“消元”操作来推进求解的进程。

同时，值得考虑的是，我们这里实质上是通过将不满秩的$\boldsymbol A$“替换”为可能满秩的$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W$来解决特征方程存在0根的问题，但是，如果$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W$因为某些内在的联系而必然不为满秩矩阵，我们的操作便失去了意义。因而，我们需要对此进行一步验证。当然这是极其简单的，配凑出一个合理的方程即可解决问题。这里我们选定方程
$$
\left(\begin{matrix}x'\\y'\\z'\end{matrix}\right)=\left(\begin{matrix}1&2&3\\2&3&4\\3&5&7\end{matrix}\right)\left(\begin{matrix}x\\y\\z\end{matrix}\right)\tag{205}
$$
因为系数矩阵的第三行由前两行相加得到，故该矩阵必然不为满秩矩阵。通过上边的规则，我们计算出
$$
\boldsymbol P=\left(\begin{matrix}1&0&0\\0&1&0\\-1&-1&1\end{matrix}\right)\tag{206}
$$

$$
\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W=\left(\begin{matrix}4&5\\6&7\end{matrix}\right)\tag{207}
$$

这里$|\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W|\ne0$，尽管我们无法确定“消元”后矩阵是否一定可逆，但我们至少可以验证，我们这种“消元”操作的根本原理应该是正确的。

接下来我们考虑多次重复“消元”的情况。

经过计算可知，若对式$(193)$继续消元，则结果会有如下形式
$$
\boldsymbol X_{LL}'=\boldsymbol B\boldsymbol X_{LL}+\boldsymbol C_1t+\boldsymbol C_2\tag{208}
$$
据此猜测，每次消元操作均会使式中关于$t$的多项式次数增加1。这可以通过数学归纳法证明，此处不再展开。

为了不失一般性，也为了顺带解决非齐次方程的情形，这里我们将上式“多项式”位置处的整体替换为一个元素为关于$t$的函数的矩阵$\boldsymbol Q$，这样得到形似的方程
$$
\boldsymbol X'=\boldsymbol{AX}+\boldsymbol Q\tag{209}
$$
然后以此整理更一般的“消元”过程。

我们类似地设$r(\boldsymbol A)=m\ge1$，并沿用前边使用的$\boldsymbol P$的形式和各矩阵的分块形式。特殊地，对于新设定的矩阵$\boldsymbol Q$，我们给出分块$\boldsymbol Q=\left(\begin{matrix}
\boldsymbol Q_L\\\boldsymbol Q_H
\end{matrix}\right)$。然后我们依此展开$\boldsymbol{PX}'=\boldsymbol{PAX}+\boldsymbol{PQ}$
$$
\left(\begin{matrix}
\boldsymbol X_L\\\boldsymbol W\boldsymbol X_L+\boldsymbol X_H
\end{matrix}\right)'=\left(\begin{matrix}
\boldsymbol A_{TL}\boldsymbol X_L+\boldsymbol A_{TR}\boldsymbol X_H\\\boldsymbol O
\end{matrix}\right)+\left(\begin{matrix}
\boldsymbol Q_L\\\boldsymbol W\boldsymbol Q_L+\boldsymbol Q_H
\end{matrix}\right)\tag{210}
$$
并将其拆分
$$
\boldsymbol X_L'=\boldsymbol A_{TL}\boldsymbol X_L+\boldsymbol A_{TR}\boldsymbol X_H+\boldsymbol Q_L\tag{211}
$$

$$
\boldsymbol W\boldsymbol X_L'+\boldsymbol X_H'=\boldsymbol W\boldsymbol Q_L+\boldsymbol Q_H\tag{212}
$$

对$(212)$两边同时求不定积分
$$
\boldsymbol W\boldsymbol X_L+\boldsymbol X_H=\int(\boldsymbol W\boldsymbol Q_L+\boldsymbol Q_H)dt\tag{213}
$$
然后
$$
\boldsymbol X_H=\int(\boldsymbol W\boldsymbol Q_L+\boldsymbol Q_H)dt-\boldsymbol W\boldsymbol X_L\tag{214}
$$
代入$(211)$
$$
\boldsymbol X_L'=(\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W)\boldsymbol X_L+\boldsymbol A_{TR}\int(\boldsymbol W\boldsymbol Q_L+\boldsymbol Q_H)dt+\boldsymbol Q_L\tag{215}
$$
这样便完成了一次降次操作。考虑到$\boldsymbol W\boldsymbol Q_L+\boldsymbol Q_H$为$(n-m)\times1$矩阵，不定积分会产生$(n-m)\cdot1$个初值条件确定的独立常数，所以，整个过程引入了$(n-m)$个独立的常数。

故若$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W$仍不为满秩矩阵，则可以继续进行这样的消元操作。不断如此，若没有遇到特征方程出现重根这一情况，则最终会有以下两种情形：

- 进行若干次降次后$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W$为满秩矩阵（或标量），可以求解原方程的部分未知函数，继而使用$(214)$这类关系式得到其它全部未知函数。
- 进行若干次降次后$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W$为零矩阵，解得部分未知函数为初值条件确定的常数函数，继而使用$(214)$这类关系式得到其它全部未知函数。

这两种情形的互补性不是非常显然，但是也可以被很容易地证明。

第一种情形成立时，第二种情形不成立是显然的。

假定$k$次降次后$\boldsymbol A_{TL}-\boldsymbol A_{TR}\boldsymbol W=\boldsymbol B_k$，若$\boldsymbol B_k$不为满秩矩阵或标量，则要么$\boldsymbol B_k$已经成为了零矩阵，要么以其为系数矩阵的方程组可以继续进行这样的消元操作。在经历一轮消元后，$\boldsymbol B_k$的次数都会严格地下降，且有$r(\boldsymbol B_{k+1})\le r(\boldsymbol B_k)-1$。已知$r(\boldsymbol A)=n$，则如此循环，$\boldsymbol B_k$的秩在不多于$n$步以内一定会降低到0。故第一种情形不成立时第二种情形必然成立。

从而，这里我们完全地给出了不涉及重根情形的一阶线性常系数常微分方程组的求解方法。

## 又N次曲折

那再来看特征值含重根的情况。

注意到处理特征根含0的情形时，推导始终没有涉及求解特征值的操作。所以，此处只有更一般的情形下会需要处理特征方程有重根的情况，而这时的情况实际上是求解系数矩阵可逆的一阶线性非齐次常系数常微分方程组。所以，接下来我们只需解决求解特征方程有重根，且系数矩阵可逆的一阶线性非齐次常系数常微分方程组这一问题即可。

### 可行性分析

到了这里，我们再次考虑一下这一类方程是否一定可以求解，即是否拥有可由原微分方程组与初值条件确定的解。

> 虽然上一节我们确定过此类方程不是必然不可解，但那时我们是把视角局限在系数矩阵不可逆的情形下，对更一般的情况的了解还大有欠缺。

我们知道，我们的方程具有$\boldsymbol X'=\boldsymbol{AX}+\boldsymbol G$的形式，则不妨将$\boldsymbol X$类比为一个质点在$n$维空间当中的“坐标”，而$\boldsymbol X'$为该点在这一空间中的“速度”，$\boldsymbol F$为可能随时间变化而与位置无关的“附加速度”。

> 尽管，前面我们（几乎）一直在考虑$\boldsymbol X'=\boldsymbol {AX}$这一方程，视$\boldsymbol G=\boldsymbol O$，现在是时候做出一点点延伸了。

倘若我们拥有一组“标准的”初值条件，为某一给定时刻下$\boldsymbol X$的取值。鉴于微分方程组给出了质点的速度随位移、时间的变化规律，如果我们知道了质点的初始位置，则它接下来的运动都是确定的。就好比将一粒木屑丢入错综复杂的急流当中，假如水流在每时每刻在每一处的速度（微分方程）以及木屑在何时何地入水（初值条件）都是可知的，则理论上我们完全可以预测出木屑接下来的运动情况。

上面的类比直观地告诉我们，只要原方程组具有$\boldsymbol X'=\boldsymbol{AX}+\boldsymbol G$这一形式（似乎也可推广到$\boldsymbol X'=f(\boldsymbol X,t)$），则它理应是可以求解的：不论唯一确定与否，木屑总归是要飘向一个方向的。

我们暂时不去严格地证明这一命题（事实上我们至此尚未得知上述原命题的正确性），而是通过上边的类比，继续考查原方程组的现实意义。

为了保持直观性，这里我们只考虑相对容易理解的三维情形（$n$维的情形可类似地理解）。由原方程，我们可以推知“速度”$\boldsymbol X'$可以被分解为与位置相关，而随时间无关的$\boldsymbol{AX}$和与位置无关而与时间相关的$\boldsymbol G$两个部分。

在这里我们主要关心第一个部分。将$\boldsymbol X$视为一个几何意义上的向量，则$\boldsymbol{AX}$是对$\boldsymbol X$应用仿射变换的结果。高中时，曾在某乎上看到关于基于矩阵的几何变换（也就是所谓仿射变换）的一条十分巧妙的解释，即仿射变换本质上是一种“换底”的操作，即使用矩阵各列向量作为新的基底，去替换掉原来坐标轴定义的单位正交基底。这一事实我们其实不难解释：
$$
\left(\begin{matrix}a_{11}&a_{12}&a_{13}\\a_{21}&a_{22}&a_{23}\\a_{31}&a_{32}&a_{33}\end{matrix}\right)\left(\begin{matrix}x\\y\\z\end{matrix}\right)=x\begin{pmatrix}a_{11}\\a_{21}\\a_{31}\end{pmatrix}+y\begin{pmatrix}a_{12}\\a_{22}\\a_{32}\end{pmatrix}+z\begin{pmatrix}a_{13}\\a_{23}\\a_{33}\end{pmatrix}\tag{216}
$$
利用这一点，我们可以很轻松地理解系数矩阵$\boldsymbol X$不满秩的本质。

我们假设$r(\boldsymbol A)=2$，则矩阵只有两个线性无关的列向量，这两个列向量会“确定”（或者说“张成”）一个平面，而第三个列向量则会恰好位于这一平面内。显然，以这三个向量作基底可表示向量必然位于上述平面当中，继而，不论$\boldsymbol X$怎样取值，$\boldsymbol{AX}$都会位于同一平面当中。在忽略$\boldsymbol G$时，这意味着，无论质点位于何处，它的速度对应的向量都必然位于同一过原点的平面以内。类似地可以证明，$r(\boldsymbol A)=1$意味着$\boldsymbol{AX}$始终在一条确定的直线内变动。这时，我们便会很自然地认同系数矩阵不可逆只会导致原方程组（及其解）拥有一些类似被“降维打击”的相对特殊的性质，但不会影响原方程组的可解性。

由这一思路，我们便得以很容易地理解系数矩阵为0和不为0的情形之间的差异与统一性。

到这里，让我们再借此机会回顾一下最初的求解过程当中引入“特征值非零”即“特征矩阵可逆”这一要求的一步

> 容易知道，$\boldsymbol{A}^T$会有$n$个特征值（以$|\boldsymbol{A}^T-\alpha\boldsymbol E|=0$根的个数计，重根可重计），不妨设它们为$\alpha_1$、$\alpha_2$、$\cdots$、$\alpha_n$，对应的一个特征向量分别为$\boldsymbol{\Lambda}^T_1$、$\boldsymbol{\Lambda}^T_2$、$\cdots$、$\boldsymbol{\Lambda}^T_n$。若特征值$\alpha_i$非零，可以解得
> $$
> \boldsymbol{\Lambda}_i\boldsymbol{X}=C_ie^{\alpha_it}\tag{138}
> $$

然后我们就会发现，$\alpha_i=0$其实并不影响式$(138)$的得出，此时该式实际上可以表达为
$$
\boldsymbol{\Lambda}_i\boldsymbol{X}=C_ie^{0}=C_i\tag{217}
$$
继而，如果特征值0不是特征方程的重根，接下来的推导同样是成立的。所以，专门对特征值0进行讨论更多的是我们的一个疏忽的结果。

那么，前边我们费了相当长的篇幅讨论的处理非满秩系数矩阵的方法就完全没有价值，吗？暂且不提。

再来考虑特征值的影响。我们知道，特征值与特征向量的定义式为$\boldsymbol{Ax}=\lambda\boldsymbol x$，而且显然地，这一定义式具有明显的几何意义，即对于一个给定的矩阵，常常存在一些特定方向上的向量（特征向量），使得使用该矩阵对那些向量施加仿射变换（相乘）的结果等于简单地按照特定倍率（特征值）缩放那些向量的结果。放到上面的类比当中，这一现象意味着存在一系列过原点的直线，使得当质点位于这些直线上时，其速度一定与直线共线（靠近或远离原点的方向），大小与质点到原点的距离成比例。

### 特例研究

#### 构造示例

貌似规律仍然不够明显，这样，我们试着构造一些系数矩阵特征值存在重根的方程组，试着从特征向量的取向和方程组的解法总结其特征值重根的实际意义。

显然地，我们可以从对角矩阵做起，因为对角矩阵的特征值恰好就是其主对角线上的元素。但是，考虑到对角矩阵本身过于特殊，且属于对称矩阵，这里我们也不能单单地考虑对角矩阵这一情形。而且，因为系数矩阵为二阶方针的情形不足以同时支持单根与重根同时出现，典型性欠佳，所以，这里我们先试着构造一个三阶的系数矩阵。

这里先来考察$n$阶方阵特征方程的展开，以备构造系数矩阵之用。矩阵$(a_{ij})$的特征方程可以写作$|(a_{ij})-\alpha\boldsymbol E|=0$，即
$$
\left|\begin{matrix}
a_{11}-\alpha&\cdots&a_{1n}-0\\
\vdots&&\vdots\\
a_{n1}-0&\cdots&a_{nn}-\alpha
\end{matrix}\right|=0\tag{218}
$$
对上述行列式的第一行应用行列式的加减规则，得
$$
\left|\begin{matrix}
a_{11}&\cdots&a_{1n}\\
a_{21}-\alpha&\cdots&a_{2n}-0\\
\vdots&&\vdots\\
a_{n1}-0&\cdots&a_{nn}-\alpha
\end{matrix}\right|+\left|\begin{matrix}
-\alpha&\cdots&0\\
a_{21}-\alpha&\cdots&a_{2n}-0\\
\vdots&&\vdots\\
a_{n1}-0&\cdots&a_{nn}-\alpha
\end{matrix}\right|=0\tag{219}
$$
设$(a_{ij})$与$\boldsymbol E$的第$i$行对应的行向量分别为$\boldsymbol a_{i}$和$\boldsymbol e_i$，上式又可写作
$$
\left|\begin{matrix}
\boldsymbol a_1\\\boldsymbol a_2-\alpha\boldsymbol e_2\\\vdots\\\boldsymbol a_n-\alpha\boldsymbol e_n
\end{matrix}\right|+\left|\begin{matrix}
-\alpha\boldsymbol e_1\\\boldsymbol a_2-\alpha\boldsymbol e_2\\\vdots\\\boldsymbol a_n-\alpha\boldsymbol e_n
\end{matrix}\right|=0\tag{220}
$$
对原行列式的每行都进行上述变换，可得一个形如$2^n$个行列式加减等于0的形式，其中每个行列式的第$i$行都可以取$\boldsymbol a_i$或者$\alpha\boldsymbol e_i$，而且这$2^n$个行列式当中会出现所有的取值组合。即
$$
\sum_{\substack{t_i=0,1\\1\le i\le n}}\left|\begin{matrix}
\boldsymbol l_1\\\vdots\\\boldsymbol l_n
\end{matrix}\right|,~
\boldsymbol l_i=\begin{cases}
\boldsymbol a_i&t_i=0\\-\alpha\boldsymbol e_i&t_i=1
\end{cases}\tag{221}
$$
我们可以用一种类似于二进制计数的方式列出所有的行列式。

这里我们在对单独的多项式进行分析。假设一个行列式中$\boldsymbol a_i$出现了$k$次，则进行若干次行交换，并对各列进行同样的行交换后，我们可以将$-\alpha$全部集中到行列式的左上角。

行交换操作后，只考虑行列式的前$n$行，则各列当中$(n-k)$列中有唯一一个元素为$-\alpha$，其余元素为0，而其它$k$列全为0。再经过列变换全为0的列就会被集中在行列式的右上角，这样，整个行列式就会成为分块形式的下三角行列式。而且，右下角的元素为$|a_{ij}|$在除去展开后的单个行列式中出现$-\alpha$的行对应的行以及序数与那些行对应的列后得到的行列式。因为这里只进行了偶数次行列交换，整个行列式的值保持不变，最终，行列式的值为$(-\alpha)^n$与右下角位置的元素组成的行列式的乘积。例如，
$$
\begin{eqnarray}
\left|\begin{matrix}
\boldsymbol a_1\\-\alpha\boldsymbol e_2\\\boldsymbol a_3\\-\alpha\boldsymbol e_4\\-\alpha\boldsymbol e_5
\end{matrix}\right|&=&\left|\begin{matrix}
-\alpha\boldsymbol e_4\\-\alpha\boldsymbol e_2\\-\alpha\boldsymbol e_5\\\boldsymbol a_1\\\boldsymbol a_3\\
\end{matrix}\right|\\
&=&\left|\begin{matrix}
0&0&0&-\alpha&0\\
0&-\alpha&0&0&0\\
0&0&0&0&-\alpha\\
a_{11}&a_{12}&a_{13}&a_{14}&a_{15}\\
a_{21}&a_{22}&a_{23}&a_{24}&a_{25}
\end{matrix}\right|\\
&=&\left|\begin{matrix}
-\alpha&0&0&0&0\\
0&-\alpha&0&0&0\\
0&0&-\alpha&0&0\\
a_{14}&a_{12}&a_{15}&a_{11}&a_{13}\\
a_{24}&a_{22}&a_{25}&a_{21}&a_{23}
\end{matrix}\right|\\
&=&-\alpha^3\left|\begin{matrix}
a_{11}&a_{13}\\
a_{21}&a_{23}
\end{matrix}\right|
\end{eqnarray}
\tag{222}
$$
这样，特征方程中的$k$次项可以表示为$(-\alpha)^n$与一系列行列式（规定0阶行列式值为1）和的乘积，而这些行列式是1至$n$之间（含两端）取$k$个整数并从原行列式删除行序数在选定整数中的行或列序数在选定整数当中的列覆盖的元素后的所有可能结果。

对于三阶行列式$(a_{ij})$，我们可以按照上述规则写出其特征方程为
$$
\begin{eqnarray}
-\alpha^3&+&(a_{11}+a_{22}+a_{33})\alpha^2\\
&-&\left(\left|\begin{matrix}a_{22}&a_{23}\\a_{32}&a_{33}\end{matrix}\right|\left|\begin{matrix}a_{11}&a_{13}\\a_{31}&a_{33}\end{matrix}\right|+\left|\begin{matrix}a_{11}&a_{12}\\a_{21}&a_{22}\end{matrix}\right|\right)\alpha\\
&+&\left|\begin{matrix}a_{11}&a_{22}&a_{23}\\a_{21}&a_{22}&a_{23}\\a_{31}&a_{32}&a_{33}\end{matrix}\right|=0
\end{eqnarray}
\tag{223}
$$
我们先给出一个对角矩阵$\mathrm{diag}(1,2,2)=\begin{pmatrix}1&0&0\\0&2&0\\0&0&2\end{pmatrix}$作为我们构造的起点，然后，我们在保持上述系数矩阵不变，且结果不构成对称矩阵的前提下对其施加两次初等变换，得到矩阵$\begin{pmatrix}1&2&0\\0&2&0\\2&0&2\end{pmatrix}$，作为我们的系数矩阵。由此可以写出方程组
$$
\begin{pmatrix}x'\\y'\\z'\end{pmatrix}=\begin{pmatrix}1&2&0\\0&2&0\\2&0&2\end{pmatrix}\begin{pmatrix}x\\y\\z\end{pmatrix}\tag{224}
$$
即
$$
\begin{cases}
x'=x+2y\\
y'=2y\\
z'=2x+2z
\end{cases}\tag{225}
$$
#### 解的形式

按照最初的方法，可以将求解过程推进到得到如下方程的步骤
$$
x-2y=C_{1}e^t\tag{226}
$$

$$
y=C_2e^{2t}\tag{227}
$$

在这样一个具体的情境下很容易注意到，我们可以借助这两个方程，将原方程组中$x'=x+2y$一式中的$y$替换下来，以推进求解的过程。但是，要进行这一操作，我们会有两种具体的做法可选，即使用$(226)$得出$2y$的表达式进行代换，或使用$(227)$直接作出代换。两种做法下，我们分别可以得到方程
$$
x'=2x-C_1e^{t}\tag{228}
$$

$$
x'=x+2C_2e^{2t}\tag{229}
$$

这样，我们实际上可以解得两个形式上不同的结果
$$
x=e^{2t}\int e^{-2t}\left(-C_1e^{t}\right)dt=C_1e^{t}+C_3e^{2t}\tag{230}
$$

$$
x=e^t\int e^{-t}\cdot2C_2e^{2t}dt=C_3'e^t+2C_2e^{2t}\tag{231}
$$

但是，初值条件确定后（即$C_1$、$C_2$确定后）这两个结果理应是相等的。这时我们不难得到$C_3'=C_1$、$C_3=2C_2$，由此，我们得知上述求解过程实际上没有引入新的独立待定常数，继而，我们可以得到
$$
x=C_1e^t+2C_2e^{2t}\tag{232}
$$
代入$z'=2x+2z$，可以解得
$$
z=e^{2t}\int e^{-2t}(2C_1e^t+4C_2e^{2t})dt=(4C_2t+C_4)e^{2t}-2C_1e^t\tag{233}
$$
这样我们便完成了原方程组的求解。

> 其正确性可自行验证

相较于最一般的不涉及重根与零根的情形，这里的结果除了某一个未知函数的解中多出形如多项式乘以原方程这一形式的项以外，似乎并没有更明显的本质差异。

### 一般化的尝试历程

>  本章节基本只有各种摸索、失败与再尝试的过程，虽然从中也收获了许多有用的经验、工具与结论，但读起来到底没有前文那么“积极向上”，若无兴趣，可直接移步下一章节。

#### 书接上回

但是，从那个案例中，我们捋出了处理特征值含重根的情形的一个处理方式，所以，这里我们尝试对这一过程使用矩阵的语言进行抽象化与一般化，希望借此推动求解进程：

第一步，我们求解出了对应式$(140)$的方程$\boldsymbol{LX}=\boldsymbol{F}$（若重根对应$\boldsymbol L$中的重数行）；

第二步，我们将$\boldsymbol{LX}=\boldsymbol{F}$与原方程组$\boldsymbol{AX}=\boldsymbol{X}'$联立，以得到一系列形如$x_i'=d_ix_i+g_i(t)$（两端只出现一个未知函数$x_i$）的方程；

第三步，求解得出的方程，再次进行回代，直至得到最终解。

第二步的联立当中，我们实质上是对两者进行等价变换（可由两端乘以一个矩阵表示）后“相加”得到一个新的方程组，即
$$
\boldsymbol{PLX}+\boldsymbol{QAX}=\boldsymbol{PF}+\boldsymbol{QX}'\tag{234}
$$
但是我们暂时不希望对$\boldsymbol X'$进行变换，因为我们希望保持最终联立出的方程组中每一标量方程的一侧只由未知函数的导数$x_i'$组成，以保持方程组的简单性。也就是说，我们希望$\boldsymbol Q=\boldsymbol I$，继而上述方程又可写作
$$
(\boldsymbol{PL}+\boldsymbol{A})\boldsymbol X-\boldsymbol{PF}=\boldsymbol{X}'\tag{235}
$$
#### 对角矩阵？

为了使上面的等式对应的方程组当中各式均具有形式$x_i'=d_ix_i+g_i(t)$，$\boldsymbol{PL}+\boldsymbol{A}$应该为一个对角矩阵$\operatorname{diag}(d_1,\cdots,d_n)$。接下来，我们试着寻找一个$\boldsymbol P$使得上述条件成立。为了实现这一点，我们需要用方程的形式准确地描述上面的条件。一个最容易想到的方法是，考虑到对角矩阵中非对角元全为0，我们可以对任意合理且满足$i\ne j$的$i$、$j$组合列出$(n^2-n)$个形式如下的方程
$$
\sum_{i=1}^np_{ik}\lambda_{kj}+a_{ij}=0\tag{236}
$$
其中，$p_{ij}$、$\lambda_{ij}$、$a_{ij}$分别为$\boldsymbol P$、$\boldsymbol L$、$\boldsymbol A$的$(i,j)$元。

因为上述方程组在理论上必然是有办法求解的（这里的求解，包括得到无解等特殊情形），所以这里我们要做的是确认$\boldsymbol P$是否一定存在，即上述方程组有解，以此验证我们做法的正确性。

我们最容易想到的思路可能是这样的。忽略$i\ne j$这一条件，上述方程全体组成的方程组实际上等价于矩阵方程$\boldsymbol{PL}+\boldsymbol A=\boldsymbol O$，其两侧的第$i$行$j$列恰好对应上面的方程的左右两侧。这是否意味着，我们可以通过某种变换，将这一矩阵方程变换为我们需要的方程组的形式呢？显然地，我们可以通过将这一矩阵方程左侧整体（$n\times n$矩阵）的对角元置为0，使这一位置上对应的方程为恒成立的方程$0=0$，从而达到排除$i\ne j$的情形的目的。但是，我们对这种变换似乎很难作出更进一步的表述，因为，要对上述方程矩阵左侧的整体进行“挖空”，我们需要预先知道$\boldsymbol P$的取值。

到这里，推导再次进入了死胡同。

且让我们再次分析一下原命题即$\boldsymbol{PL}+\boldsymbol A=\operatorname{diag}(d_1,\cdots,d_n)$。我们知道，这一矩阵方程实际上可以“标准化”地写成$\boldsymbol L^T \boldsymbol P^T=(\operatorname{diag}(d_1,\cdots,d_n)-\boldsymbol A)^T$，这样，该方程有解的条件可以表示为$r(\boldsymbol L^T)\ge r(\boldsymbol L^T,\operatorname{diag}(d_1,\cdots,d_n)-\boldsymbol A)$。但是，这里$\boldsymbol L^T$并不为满秩矩阵，然而右侧的部分却可能是满秩的，继而$r(\boldsymbol L^T,\operatorname{diag}(d_1,\cdots,d_n)-\boldsymbol A)$不一定小于$r(\boldsymbol L^T)$，方程的解$\boldsymbol P$不一定存在。当然，这里我们假定了$\operatorname{diag}(d_1,\cdots,d_n)$为一个确定值，而这里的情况下这一矩阵是待定的，其对角元理应可以任意取值，但是，直觉告诉我们，$n$个可变元素提供的“自由度”似乎并不能支持在$r(\boldsymbol L)$过低的情况下$\boldsymbol P$依然有解。

#### 递归处理？

暂且不对上边的推测做更深入的探讨。类比回我们构造的方程组，我们发现，我们在第一次联立完成时只得到了$x$、$y$两个函数的表达式，而得到$z$则需要第二次联立。同时，我们注意到，我们的系数矩阵有两个线性无关的特征向量，即$r(\boldsymbol L)=2$，这恰好是我们在第一次联立中得到的方程的数目。于是我们给出一个十分激进的猜测，即“$r(\boldsymbol L)$等于几就能解出多少目的形式的方程”。这样得到目的形式的方程并求解后，我们又可以得到新的方程组，循环往复，直至求解完成。

> 这实际上沿袭了特征值含0的情形的处理思路，即逐步降阶求解，不必一次性完成。

在这一导向下，我们可以得出一种新的求解思路。我们知道，我们将$\boldsymbol{PL}+\boldsymbol A$表示为矩阵方程的实质就是将$\boldsymbol L$的每列（同一个未知函数的系数）线性组合后与$\boldsymbol A$的某一行相加，发生抵消，使所得结果的某些元素为0，或者说只有一部分元素可以取得非零值。设$\boldsymbol P$的第$(i,j)$元行为$p_{ij}$，$\boldsymbol L$的第$i$列为$\boldsymbol l_i$，$\boldsymbol A$的第$i$行为$\boldsymbol a_i$，这样上述条件可以表示为
$$
\sum_{j=0}^np_{ij}\boldsymbol l_j+\boldsymbol a_j=\mathrm{只在第}i\mathrm{列可能非零的行向量}\tag{237}
$$
我们知道，假如我们只截取$\boldsymbol A$的前$m$行$\boldsymbol A_L$，则$\boldsymbol A_L$行向量组的秩$r(\boldsymbol A_L)\le m$，如果$r(\boldsymbol L)\ge m$，则我们必然可以用$\boldsymbol L$行向量的线性组合表述出$\boldsymbol A_L$的任一行向量，继而，我们一定可以给出一个$(n-m)\times n$矩阵$\boldsymbol P_L$，使得$\boldsymbol P_L L+\boldsymbol A_L=\boldsymbol O$。在这样一个“更强”的方程都有解的情况下，使得$\boldsymbol{PL}+\boldsymbol A$为对角矩阵的$\boldsymbol P$就显得“更存在”了。

但是我们该如何用一种优雅的形式表示$\mathbf P$的求解方式呢？我们知道，要得到需要的对角矩阵，只需保证非主对角线位置的元素为0即可，不需要关注主对角线位置的元素取值情况，从而，我们实际上也无需关注$\boldsymbol A$主对角线上元素的取值。一个显然的方法是删去那些元素，并通过上移下方元素，使$\boldsymbol A$再次被补齐为$(n-1)\times n$矩阵，或者在删去后左移右侧元素做一次补齐。但这样的运算似乎很难用矩阵表示。

#### 全零分块？

然而，当我们“一行一行”地考虑方程$\boldsymbol{PL}+\boldsymbol A=\boldsymbol D$、“一行一行地”求解$\boldsymbol P$的取值，情况就会有所改观。实际上，假若我们规定记号$\boldsymbol M_{r_i}$、$\boldsymbol M_{c_i}$分别为$\boldsymbol M$的第$i$行和第$j$列，$\boldsymbol{PL}+\boldsymbol A=\boldsymbol D$就可以表示为以下一系列方程组成的方程组：
$$
\boldsymbol P_{r_i}\boldsymbol L+\boldsymbol A_{r_i}=\sum_{k=1}^n p_{ik}\boldsymbol L_{c_k}+\boldsymbol A_{r_i}=\boldsymbol D_{r_i}\tag{238}
$$
倘若我们规定$\boldsymbol M\backslash c_i$和$\boldsymbol M\backslash r_i$分别为从$\boldsymbol M$剔除第$i$列和第$i$行的结果，则我们剔除$\boldsymbol D_{r_i}$中唯一可能非零的一列以及等式其它各段的同一列之后，方程可表示为
$$
\sum_{k=1}^n p_{ik}\boldsymbol L_{c_k}\backslash c_i+\boldsymbol A_{r_i}\backslash c_i=\boldsymbol P_{r_i}(\boldsymbol L\backslash c_i)+\boldsymbol A_{r_i}\backslash c_i=\boldsymbol O\tag{238}
$$
这样我们实际上构造出了一个关于$\boldsymbol P_{r_i}$的确定的线性方程组。

我们将其化作我们所惯用的标准形式：
$$
(\boldsymbol L\backslash c_i)^T(\boldsymbol P_{r_i})^T=-(\boldsymbol A_{r_i}\backslash c_i)^T\tag{239}
$$


鉴于$(\boldsymbol L\backslash c_i)^T$不为方阵，而是一个$(n-1)\times n$的矩阵，为方便接下来的操作，我们不妨在其下方补上一行0，在上述方程成立的要求下方程右侧也应同时补零，得到方程
$$
\begin{pmatrix}
(\boldsymbol L\backslash c_i)^T\\\boldsymbol O
\end{pmatrix}(\boldsymbol P_{r_i})^T=
\begin{pmatrix}
-(\boldsymbol A_{r_i}\backslash c_i)^T\\\boldsymbol O
\end{pmatrix}\tag{240}
$$
我们假定$r\begin{pmatrix}
(\boldsymbol L\backslash c_i)^T\\\boldsymbol O
\end{pmatrix}=m$，则我们可以抽取其中$m$个线性无关的行，使用初等行变换将其变换到前$m$行组成分块$\boldsymbol L_m$，并将未被抽取的行化为全零。如果将上述行初等变换设为初等矩阵$\boldsymbol S$，我们得到
$$
\boldsymbol S\begin{pmatrix}
(\boldsymbol L\backslash c_i)^T\\\boldsymbol O
\end{pmatrix}(\boldsymbol P_{r_i})^T=
\begin{pmatrix}
\boldsymbol L_m\\\boldsymbol O
\end{pmatrix}(\boldsymbol P_{r_i})^T
=\boldsymbol S
\begin{pmatrix}
-(\boldsymbol A_{r_i}\backslash c_i)^T\\\boldsymbol O
\end{pmatrix}=\boldsymbol B\tag{241}
$$
其中$\boldsymbol B$是为方便下文的表述而新设定的。

我们可以将上式第二段和最后一段同时删去前$m$行以外的内容，得到方程
$$
\boldsymbol L_m(\boldsymbol P_{r_i})^T=\hat{\boldsymbol B}\tag{242}
$$
鉴于$\boldsymbol L_m$是我们特意选出的各行线性无关的矩阵，所以
$$
r(\boldsymbol L_m)=m\le n-1\tag{243}
$$
同时，受行数限制
$$
r(\boldsymbol L_m,\hat{\boldsymbol B})=m=r(\boldsymbol L_m)\tag{244}
$$
所以，方程$(242)$实际上是可以唯一地求解的。这意味着什么呢？我们知道，因为式$(240)$中新加入且全零的最后一行与其它各行均线性相关，所以它在变换$\boldsymbol S$中不会被移动。考虑到

